// Copyright (c) 2017
// Commonwealth Scientific and Industrial Research Organisation (CSIRO)
// ABN 41 687 119 230
//
// Author: Kazys Stepanas
#include <gtest/gtest.h>

#include <gputil/gpuApiException.h>
#include <gputil/gpuBuffer.h>
#include <gputil/gpuDevice.h>
#include <gputil/gpuKernel.h>
#include <gputil/gpuProgram.h>
#include <gputil/gpuQueue.h>

#include <chrono>

#if GPUTIL_TYPE == GPUTIL_OPENCL
#include "matrixResource.h"
#endif // GPUTIL_TYPE == GPUTIL_OPENCL

extern gputil::Device g_gpu;

const void *matrixMultiplyPtr();

namespace gpukernel7test
{
  const unsigned kN = 32;
  extern const float kMatrixA[kN * kN];
  extern const float kMatrixB[kN * kN];

  /// Log a @c std::chrono::clock::duration to an output stream.
  ///
  /// The resulting string displays in the smallest possible unit to show three three
  /// decimal places with display units ranging from seconds to nanoseconds. The table below
  /// shows some example times.
  ///
  /// Time(s)     | Display
  /// ----------- | --------
  /// 0.000000018 | 18ns
  /// 0.000029318 | 29.318us
  /// 0.0295939   | 29.593ms
  /// 0.93        | 930ms
  /// 15.023      | 15.023s
  /// 15.000025   | 15.000s
  ///
  /// Note that times are truncated, not rounded.
  ///
  /// @tparam D The duration type of the form @c std::chrono::clock::duration.
  /// @param out The output stream to log to.
  /// @param duration The duration to convert to string.
  template <typename D>
  inline void logDuration(std::ostream &out, const D &duration)
  {
    const bool negative = std::chrono::duration_cast<std::chrono::nanoseconds>(duration).count() < 0;
    const char *sign = (!negative) ? "" : "-";
    D abs_duration = (!negative) ? duration : duration * -1;
    auto s = std::chrono::duration_cast<std::chrono::seconds>(abs_duration).count();
    auto ms = std::chrono::duration_cast<std::chrono::milliseconds>(abs_duration).count();
    ms = ms % 1000;

    if (s)
    {
      out << sign << s << "." << std::setw(3) << std::setfill('0') << ms << "s";
    }
    else
    {
      auto us = std::chrono::duration_cast<std::chrono::microseconds>(abs_duration).count();
      us = us % 1000;

      if (ms)
      {
        out << sign << ms << "." << std::setw(3) << std::setfill('0') << us << "ms";
      }
      else
      {
        auto ns = std::chrono::duration_cast<std::chrono::nanoseconds>(abs_duration).count();
        ns = ns % 1000;

        if (us)
        {
          out << sign << us << "." << std::setw(3) << std::setfill('0') << ns << "us";
        }
        else
        {
          out << sign << ns << "ns";
        }
      }
    }
  }

  template <typename T, typename R>
  inline std::ostream &operator<<(std::ostream &out, const std::chrono::duration<T, R> &d)
  {
    logDuration(out, d);
    return out;
  }
  using TimingClock = std::chrono::high_resolution_clock;

  TEST(GpuKernel, Simple)
  {
    int err = 0;
    gputil::Program program(g_gpu, "test-program");

    err = GPUTIL_BUILD_FROM_SOURCE(program, matrixCode, matrixCode_length, gputil::BuildArgs{});

    ASSERT_EQ(err, 0) << gputil::ApiException::errorCodeString(err);

    gputil::Kernel kernel = GPUTIL_MAKE_KERNEL(program, matrixMultiply);
    ASSERT_TRUE(kernel.isValid());

    kernel.addLocal([](size_t group_size)
    {
      return group_size * sizeof(float);
    });

    kernel.calculateOptimalWorkGroupSize();

    gputil::Queue queue = g_gpu.defaultQueue();

    gputil::Buffer matrix_a(g_gpu, sizeof(kMatrixA), gputil::kBfRead);
    gputil::Buffer matrix_b(g_gpu, sizeof(kMatrixB), gputil::kBfRead);
    gputil::Buffer matrix_out(g_gpu, sizeof(float) * kN, gputil::kBfWrite);

    const auto gpu_start = TimingClock::now();
    size_t copy_bytes = 0;
    copy_bytes = matrix_a.write(kMatrixA, sizeof(kMatrixA));
    ASSERT_EQ(copy_bytes, sizeof(kMatrixA));
    copy_bytes = matrix_b.write(kMatrixB, sizeof(kMatrixB));
    ASSERT_EQ(copy_bytes, sizeof(kMatrixB));
    err = kernel(gputil::Dim3(kN), gputil::Dim3(kN), &queue, gputil::BufferArg<float>(matrix_out),
                 gputil::BufferArg<float>(matrix_a), gputil::BufferArg<float>(matrix_b), kN);
    ASSERT_EQ(err, 0) << gputil::ApiException::errorCodeString(err);
    queue.finish();

    // Copy results from GPU.
    std::vector<float> gpu_results(kN);
    copy_bytes = matrix_out.read(gpu_results.data(), sizeof(*gpu_results.data()) * gpu_results.size());
    ASSERT_EQ(copy_bytes, sizeof(*gpu_results.data()) * gpu_results.size());
    const auto gpu_end = TimingClock::now();
    std::cout << "GPU time: " << (gpu_end - gpu_start) << std::endl;

    // Calculate in CPU.
    std::vector<float> cpu_results(kN);

    const auto cpu_start = TimingClock::now();
    for (unsigned i = 0; i < kN; ++i)
    {
      float &out = cpu_results[i];
      out = 0;
      for (unsigned j = 0; j < kN; ++j)
      {
        out += kMatrixA[i * kN + j] * kMatrixB[j * kN + i];
      }
    }
    const auto cpu_end = TimingClock::now();
    std::cout << "CPU time: " << (cpu_end - cpu_start) << std::endl;

    // Validate results.
    for (size_t i = 0; i < gpu_results.size(); ++i)
    {
      EXPECT_NEAR(gpu_results[i], cpu_results[i], 1e-3f);
    }
  }

  const float kMatrixA[kN * kN] = //
    { -5.36024, 3.03301,  7.89674,  -6.46361, 2.37263,  6.38046,  -4.85497, 4.01736,  -5.83961, -0.30897, 2.34736,
      9.19266,  -4.81157, 5.12527,  -6.22901, 4.46971,  3.42575,  8.55879,  5.77094,  4.38269,  -1.98192, -3.92955,
      -7.52568, 5.00008,  -2.03231, -0.67967, -5.99790, -9.10126, 6.17714,  -1.57793, -9.70259, -1.88551, -4.55362,
      6.07408,  -1.24905, -2.56581, -2.32887, 0.18148,  2.41612,  -7.29838, -1.10756, 9.76593,  -3.10208, 5.38991,
      -3.62616, -3.80617, 8.14205,  5.79305,  1.71217,  4.25061,  -6.16396, -0.55964, 7.84027,  6.69293,  -1.74443,
      0.32048,  2.04413,  2.42060,  -2.69034, -1.81077, -7.80228, -3.67605, -7.90027, -1.35433, -5.90841, 6.49489,
      -5.28090, 4.95714,  -9.37658, -4.61623, 6.33320,  9.05788,  7.74236,  -0.84028, -6.64415, 1.74848,  5.77861,
      -3.17352, 1.21083,  5.08367,  -7.72516, 6.42745,  -9.83351, -9.70465, -3.54772, -7.37416, -2.08868, 3.56927,
      -3.43333, -3.02251, 7.18175,  -8.15131, -6.03459, -1.73443, -0.91152, -3.75740, 6.19633,  4.14575,  -5.37607,
      -7.36705, 8.89244,  1.39289,  1.53383,  1.12498,  -5.87719, -4.37070, -6.50984, 3.57958,  5.40322,  -4.65746,
      -5.70183, -7.44602, 7.56560,  -6.92505, 6.06597,  -8.85882, 8.20909,  -8.84451, -7.55648, -4.73150, -0.96385,
      0.38258,  -3.10631, 9.93032,  -7.06206, 4.61396,  -6.19065, 8.91965,  -3.56298, 0.67778,  7.93350,  9.53591,
      5.65004,  2.51638,  -9.49472, -8.75178, 4.07173,  -4.84450, -1.54252, -0.56567, 7.19198,  -2.53427, -4.16850,
      1.47983,  -5.05385, 4.89241,  -6.33212, -0.49553, 8.43587,  -4.96575, -6.58216, -9.68587, -1.80548, 8.79417,
      6.98266,  4.28916,  0.70989,  1.61469,  -9.07296, -1.58392, -7.42654, -2.39975, -2.34463, -6.53747, -1.00427,
      -8.92843, 2.95637,  3.31480,  -9.64551, -8.64690, -3.58853, 4.24319,  7.50260,  -3.61401, -9.91683, -4.56730,
      -6.58313, -8.46006, -6.66975, 0.09210,  -8.16130, 2.19071,  -7.38338, -7.32992, 1.43260,  4.27257,  -6.88868,
      -4.32963, -7.59036, 1.21713,  6.43214,  -8.95334, -1.72864, -1.03092, 5.44935,  0.31199,  -8.90184, 4.49388,
      7.20876,  7.47423,  -2.83166, 5.43556,  9.89562,  -1.17701, 2.41719,  0.93132,  -2.64796, 6.97072,  6.98565,
      -1.43908, 9.49609,  -8.53626, 5.72548,  0.14453,  3.07307,  1.92560,  2.96141,  7.39365,  5.07517,  -3.35717,
      -9.99346, -8.71735, 4.27034,  4.41887,  -5.94145, 6.74185,  4.45710,  0.85286,  6.23896,  -1.69507, -0.28377,
      2.36344,  7.08174,  3.88279,  -0.17452, -3.92190, 4.72935,  -6.47502, -7.46027, -7.74994, 2.08494,  -7.89875,
      9.70752,  -0.47615, -2.94333, -8.64008, -8.43222, 1.79943,  -0.72707, -5.05841, 8.19380,  -9.77925, -7.57259,
      -9.98601, 5.58037,  9.71955,  -9.63579, -6.12072, 7.87742,  -3.50368, 2.67012,  -9.73830, -3.51469, 2.88600,
      1.19969,  5.83671,  8.51835,  3.37408,  5.75521,  1.05292,  8.05218,  -6.35638, -9.35331, -6.83586, -9.18902,
      7.46615,  4.29568,  -5.33234, 7.68480,  1.73829,  8.37063,  0.37742,  -7.88483, 6.52919,  2.11953,  -6.10367,
      4.85482,  -3.29317, -8.08474, -8.98830, 4.65221,  -1.64774, -6.80234, 3.86627,  9.08059,  3.37334,  1.56074,
      -7.22893, 0.11437,  -6.27332, 8.09680,  -2.57089, 1.01584,  -6.95102, -1.32714, -2.38946, -1.19276, -7.92486,
      -4.55988, 9.77793,  -4.71558, 2.69454,  -3.19649, 8.08590,  2.44223,  7.55874,  -2.88437, 6.44491,  -8.84439,
      9.65934,  -2.88316, 6.63873,  6.22111,  -0.94517, 1.12322,  1.39204,  -1.52287, 5.85185,  0.40659,  -2.79680,
      -8.36758, -8.92702, -4.47743, -1.12899, 2.93885,  4.55356,  7.32685,  3.61080,  -3.09299, 3.34278,  7.43658,
      -8.00631, 3.95550,  3.51196,  7.91253,  5.53583,  7.71750,  6.74937,  6.30989,  -9.09123, -0.55358, -1.26978,
      6.43639,  -0.07554, -1.55975, 7.11895,  -6.25526, -5.50645, 6.79627,  -3.74662, 6.33883,  9.51613,  8.90242,
      4.62723,  -5.18018, 8.09495,  -5.46958, -5.39303, -7.75632, -6.12000, 3.55112,  7.44182,  -9.13721, 2.42484,
      7.64426,  0.46464,  -2.24053, 4.31547,  -8.39008, 4.22868,  -8.98346, -0.08195, -2.41010, 3.90651,  -8.87544,
      1.98014,  5.76648,  7.06711,  7.60926,  0.86063,  1.39293,  -3.60422, 0.49759,  8.38953,  -6.78263, -7.37406,
      3.63870,  7.58595,  -0.20697, -8.83972, 0.26591,  -5.29550, -6.75722, 4.18623,  -6.89695, -0.03029, -1.04303,
      3.63271,  -6.79129, -7.75546, 6.29580,  -9.10068, 8.01421,  -7.27066, -6.83203, 9.06481,  -3.64834, -0.86170,
      -8.12355, -3.06568, 1.20411,  3.69757,  -6.66817, -2.82572, 8.17502,  3.21200,  -3.59027, -4.94095, -1.46972,
      -1.07293, -6.52541, 0.08928,  1.53614,  7.96836,  -3.74326, -3.75225, -3.38809, 2.67324,  -5.92884, 1.06186,
      -2.23427, 2.54998,  4.38539,  -4.85867, 9.55938,  -3.87439, -1.59161, 6.58846,  -4.76559, -3.40654, -0.57622,
      -5.13035, -2.22436, -1.33697, -3.96378, 0.05732,  3.21759,  -5.40274, 1.15436,  3.44465,  -0.73830, 7.67949,
      9.65987,  0.31785,  8.12037,  -8.01185, 7.60512,  -5.86755, 8.77293,  -6.75717, -2.89329, -5.79838, -7.94096,
      -1.10030, -8.30164, -4.31436, 4.81738,  -4.44737, 0.23332,  7.57553,  3.65214,  1.03828,  -4.95143, -5.18061,
      6.88024,  -1.84921, -0.49890, 9.95765,  6.68037,  2.39398,  -1.63835, 0.77123,  -1.98306, 4.92871,  -3.54779,
      8.01561,  5.38072,  -1.35251, -5.72469, 4.63131,  6.28110,  -2.05917, 5.05418,  -1.96820, 0.26304,  -3.35312,
      -8.72488, -4.31363, 2.09205,  1.34882,  -8.02546, -0.89581, -6.26459, -3.93678, 1.68485,  -9.94318, 9.65893,
      -2.57243, 0.31969,  -8.32212, 3.05471,  -0.73482, -2.51721, -3.15348, -8.68139, 0.04443,  -4.44787, 4.30533,
      1.07191,  -9.43039, -7.51728, -3.40529, -8.44354, -6.64094, -6.72808, 6.99461,  3.27563,  7.80686,  8.33628,
      -1.53385, 5.04029,  -8.32624, 4.43213,  1.22868,  -2.93367, -1.88713, -5.11814, -2.45039, 0.51051,  -6.97197,
      -1.15625, -7.82870, -2.22295, 8.50125,  -1.41646, 7.43619,  4.90238,  6.69840,  -6.78077, -2.19466, -2.07207,
      1.12748,  -8.75182, -8.09828, 8.30520,  -8.90648, -7.00372, 1.30008,  -7.46223, -5.07510, 4.41644,  -3.87758,
      -5.16742, -5.74961, -5.13970, -4.48847, 2.57534,  -7.58444, -6.22609, -7.25655, 5.92211,  -5.16910, -2.96338,
      0.02568,  -0.17946, 3.99880,  -5.41442, 7.44778,  -7.06188, 2.98760,  3.37074,  1.51384,  5.91171,  8.52166,
      -1.82390, 4.18569,  -1.64458, -6.09212, 4.97994,  3.00369,  -2.73404, 4.76250,  2.59263,  -5.31223, 2.18863,
      2.61276,  8.79504,  2.70871,  9.23223,  -4.30108, 1.52192,  -7.93707, -7.49678, 2.14144,  6.98578,  -9.50332,
      5.69072,  4.46349,  3.46314,  -5.13240, -9.64027, 5.65795,  8.53658,  1.14730,  6.73145,  -6.27883, -5.73621,
      9.34599,  0.48297,  -3.98020, 5.93749,  9.03804,  -7.68380, 2.96965,  3.48118,  -5.21574, -2.72929, 6.84835,
      5.74761,  -3.31882, 1.19517,  9.46701,  6.26552,  -4.95271, 9.61201,  9.67824,  6.49148,  4.01508,  0.74510,
      -9.28003, 4.88930,  6.57170,  8.22741,  6.64313,  7.29528,  2.41739,  -1.84803, -8.01405, -3.60924, 2.71333,
      -9.01155, -4.14871, -6.24235, 5.38007,  -2.16414, 5.85224,  -0.57668, 7.28138,  6.31025,  2.66814,  6.15197,
      -0.70156, -2.19628, 4.90916,  1.35013,  2.50890,  -4.20175, -3.60368, -8.59165, -1.10329, -7.19165, -4.87665,
      6.73913,  1.10513,  5.73071,  8.86371,  4.79894,  2.93544,  2.91481,  7.39946,  5.68901,  -2.34821, -5.85872,
      -7.25887, 6.46002,  6.08832,  5.65362,  9.87776,  5.09161,  -0.01409, -4.96815, -5.66504, 7.71045,  -3.27393,
      -4.29291, -1.78235, -7.61528, 2.95097,  -5.73902, -8.70765, 2.39502,  7.04027,  -4.73373, 1.09950,  9.62861,
      9.98262,  4.93704,  -6.33815, -5.94339, -9.57139, -6.03906, -5.27811, -5.01243, 3.01877,  8.96819,  7.47303,
      -2.31526, -5.66858, -2.71667, 1.72024,  0.11318,  -2.70216, 6.07467,  9.78337,  -4.72329, -4.02421, -0.18395,
      5.27181,  3.96694,  -7.48053, -6.92074, -3.42988, -2.40490, 9.77333,  -0.30730, 4.37769,  2.63065,  0.53899,
      -3.11768, 5.71806,  8.91440,  8.94023,  8.02451,  5.28794,  0.70042,  -4.69685, -8.20483, -2.71358, 8.24728,
      -9.17618, 0.20763,  -6.70992, -4.39054, 0.62377,  -6.60567, 1.77831,  -7.72461, -7.43482, -8.09086, -4.98254,
      7.44223,  3.77624,  9.52371,  9.37664,  -9.34868, 3.35080,  -6.27862, -8.37104, -8.24965, -1.84965, -8.86093,
      0.18754,  1.22750,  4.23103,  -1.45596, -3.03658, -7.51905, -1.39812, 2.69410,  -3.25497, 1.77429,  -7.11159,
      -4.00556, 4.15675,  -5.66598, -0.44158, -9.76796, 9.54147,  -9.86836, -4.84623, -1.09882, -9.89516, 5.35354,
      9.58199,  -4.00881, 9.91393,  -5.05084, 4.24625,  -7.21973, -1.75442, 4.37824,  -8.95964, -6.88128, -5.19692,
      3.27883,  -0.78038, 8.13298,  6.63811,  -0.86566, 6.81223,  -9.96513, -9.50483, -1.65841, -3.17166, 4.88875,
      -8.84550, 4.35808,  -5.93102, 7.72902,  -4.47840, 0.94915,  8.90513,  -2.34326, -5.83943, 0.80032,  9.48064,
      -8.88043, -8.53178, 8.49664,  -2.25810, 4.40557,  -5.06630, -1.88566, 3.45469,  2.00550,  -8.32170, 6.64334,
      9.36825,  -6.39497, -9.24162, 5.66811,  8.15070,  -9.85093, 7.74863,  -3.68800, 7.97893,  -4.50936, -3.12566,
      -6.79998, 1.17077,  -1.42418, 6.95268,  -8.15174, 6.24649,  -7.90176, -7.18254, -0.01591, 1.21140,  4.71176,
      -7.12009, -1.44458, -7.25360, 9.59549,  3.24089,  1.61594,  4.44725,  -7.77722, -9.66682, -9.12136, 5.34722,
      -7.76316, -2.12404, 6.59313,  -8.92211, 1.71711,  -3.43437, -9.18456, 7.97844,  8.35414,  -3.04156, 5.70274,
      3.46606,  0.59527,  5.55289,  6.19152,  -1.46750, -5.02463, 9.02596,  -4.21127, 3.32164,  -8.33186, 4.49628,
      0.28004,  2.55836,  6.85301,  -4.94816, -9.18357, 1.71467,  -4.22061, 5.04427,  2.10975,  2.49635,  6.53246,
      2.67699,  5.66162,  1.25500,  -0.36122, 9.59258,  5.01117,  -9.81135, 7.09733,  1.14298,  -7.04834, 0.16270,
      -3.23290, -8.00067, -1.88708, -3.64277, -5.08015, -6.67229, -7.38615, -6.44324, -1.64319, -2.12077, -9.58402,
      -4.62701, 6.63675,  3.77680,  -2.78879, -3.81928, 2.92034,  -5.45090, -7.53028, 7.72819,  -8.86762, 6.86855,
      7.02809,  -4.87721, 1.48462,  0.20060,  8.67957,  -2.56093, -6.42348, 0.37000,  9.35188,  9.18333,  -9.44512,
      -0.96261, -3.07814, 7.24771,  -9.80699, -5.89575, 5.21080,  0.42694,  -8.56844, 4.09713,  8.89651,  -5.50764,
      0.76284,  7.66084,  -6.09291, -6.84949, 8.99053,  -2.49485, 8.34431,  3.49296,  9.39794,  8.03067,  -0.34257,
      4.59870,  -8.20489, -2.41027, -5.17759, 4.23562,  5.27438,  5.16272,  -1.55350, -1.10750, -0.26884, -7.34586,
      -3.73046, 4.65437,  -9.48321, -4.41696, 2.21830,  2.05298,  -9.80857, 1.29349,  -3.08281, 5.69946,  -0.37416,
      -3.32929, -1.89301, 5.33941,  8.28091,  1.60708,  -4.06870, 5.07272,  7.90258,  -4.51025, 1.08962,  -6.81522,
      -2.66204, 3.71443,  0.81955,  4.86542,  -6.39781, 1.47674,  0.07887,  -4.24451, 2.11837,  1.66433,  5.47027,
      8.70229 };

  const float kMatrixB[kN * kN] =  //
    { 9.72021,  6.49670,  -7.54882, -8.00339, 9.95481,  4.63599,  4.20078,  -4.27181, 0.30477,  7.84052,  2.90157,
      -6.98213, 7.47744,  -7.89820, -7.65084, 2.48255,  1.32322,  -6.52176, 4.50639,  -3.53208, -5.74609, 3.93423,
      2.71765,  -8.25343, -0.35546, 0.94940,  -9.00612, 0.58083,  5.97516,  6.82584,  1.93767,  5.77743,  -6.12759,
      -9.13520, 4.31707,  7.22972,  -7.86060, 3.07278,  -1.19097, -0.84330, -3.17867, 6.15698,  -6.53906, 4.97187,
      -8.34039, 5.87001,  -1.54037, -7.58075, -9.56430, 6.75385,  5.76880,  2.87913,  -4.01859, -1.37107, -9.25824,
      7.36066,  -8.28706, -4.43314, 2.24932,  2.66087,  -3.18037, -8.11990, 2.24388,  3.49329,  7.75417,  -9.57024,
      1.95602,  -1.52300, -4.80017, 9.40973,  -9.52204, -2.72032, 3.66919,  1.47221,  -8.97749, 7.80755,  -3.92024,
      3.61067,  9.26715,  -6.90612, -0.61920, -7.27325, 1.82546,  3.50142,  5.60867,  -4.10997, -3.31390, -7.62985,
      0.44593,  -2.09340, 5.86013,  -2.96442, -8.30453, -3.08324, 1.55652,  3.80774,  5.96238,  9.92005,  -3.10870,
      1.66077,  2.70532,  6.21491,  3.05901,  -7.99205, -9.86389, -0.51518, -5.36827, -2.75489, 3.29030,  -4.18169,
      7.43399,  -6.65926, -6.55035, -5.33037, -6.13122, 5.14048,  -5.20897, -4.77415, 0.73274,  6.44297,  3.99113,
      6.58172,  -0.87100, 2.19202,  4.37717,  4.37294,  -3.53482, 5.26908,  -7.14042, -0.19742, 5.79998,  -7.74966,
      9.06204,  0.59119,  5.91872,  -1.26244, -9.30614, 1.60701,  -9.77323, 7.84483,  -0.49254, 1.09524,  -2.61935,
      -1.54054, 3.64331,  9.23285,  4.14123,  6.48069,  -2.40550, -7.77255, 5.96298,  -8.09423, -5.23870, -3.21136,
      -8.94306, -3.34556, 8.70678,  -3.15603, 2.92980,  1.83122,  5.69786,  9.91403,  -3.72939, -5.29828, 7.88044,
      5.02729,  8.64174,  -4.67439, -3.60892, -0.31501, 5.45154,  4.44833,  -7.38359, -2.57008, 5.05439,  6.14216,
      8.33218,  -6.91002, -5.85057, 9.38616,  8.51808,  -1.40023, 5.30463,  6.06921,  9.31414,  -5.25626, 0.50421,
      9.37392,  6.20538,  -5.25048, 9.28179,  7.46624,  -4.29274, -3.99396, -1.70260, -1.41805, -2.99618, -4.14984,
      -4.43649, 0.22653,  -3.85346, -6.16905, -1.03679, 9.48265,  6.99228,  4.37460,  0.88836,  -8.59612, -0.10017,
      8.61519,  1.44506,  -1.95708, 0.61289,  -2.03448, -4.29022, 3.46706,  3.58971,  -2.08406, -0.12826, -6.55930,
      -5.53889, 5.33895,  4.95526,  -6.79917, 4.64243,  -0.96457, -8.80923, 7.97795,  2.52293,  5.33506,  0.93494,
      -4.64497, -9.66885, 6.96163,  -5.15156, -9.57337, 2.04115,  4.53541,  -7.96206, 4.67903,  -0.95967, -3.80926,
      9.72102,  6.95524,  8.96244,  -1.85067, 8.34267,  9.20739,  -2.97400, 0.50522,  4.45701,  -2.45030, -9.37817,
      0.51074,  -0.64578, -1.08584, 0.93652,  9.04023,  -0.38636, -0.92356, 5.74699,  1.76563,  8.96288,  5.37908,
      1.03215,  -3.62605, -1.49537, -9.85393, -1.15119, 3.10760,  -1.09071, -0.44696, 4.50947,  1.11015,  -6.82136,
      -2.81877, -8.25014, -1.69993, 3.39525,  6.94262,  9.30892,  -0.91876, -7.59360, -3.07290, -6.58888, -8.53159,
      -5.13604, 4.48454,  4.35136,  9.60140,  -4.84089, 4.81833,  3.76677,  5.70460,  -9.98024, 4.96289,  0.57483,
      -6.88775, 9.53015,  -8.31271, -3.50710, -8.36483, -7.66609, -9.78223, -7.69138, -6.74942, 9.82744,  -4.79658,
      -5.08425, 0.58182,  -9.45953, 2.42277,  -8.02090, -2.17367, -2.36670, -5.69205, 6.37509,  9.93978,  7.07821,
      0.04397,  4.21192,  2.26467,  1.84011,  8.99113,  4.24749,  0.21837,  -1.81613, -9.64470, 2.29366,  -0.08927,
      -2.86600, -3.90374, 2.29998,  -7.22178, 2.46880,  -2.22964, 8.15552,  7.34957,  8.34927,  9.99332,  0.90497,
      -8.41086, -3.36952, 0.03720,  -4.21072, 4.74920,  1.94162,  3.85573,  -3.48802, 4.34596,  -1.90485, -0.13649,
      9.01643,  -6.86455, -5.64406, 0.56684,  -7.40443, 3.03110,  3.16201,  -0.50511, -1.95300, 1.86506,  -2.57450,
      8.32579,  -8.20120, -1.86530, 9.84893,  8.08739,  7.01831,  2.31716,  3.77998,  3.89498,  6.77104,  -9.78017,
      -9.93904, 8.96840,  -4.54495, -4.99620, 2.91460,  -7.72258, 3.79553,  -1.70769, 3.52195,  -7.85207, 4.08745,
      4.18976,  -2.19477, 4.42266,  6.44037,  0.03779,  -6.08180, 6.59765,  2.98794,  8.87748,  2.37885,  -9.15098,
      -3.68875, -6.28752, -3.12921, 2.56893,  0.04527,  7.34534,  6.84835,  4.55525,  2.56147,  0.32295,  4.09264,
      -9.77629, -2.20164, 8.98122,  -2.37686, 3.67821,  -8.71226, -3.63423, -3.95822, -5.07941, -6.28217, 5.45521,
      8.29136,  -3.95979, 5.34883,  8.49710,  -9.45647, 3.52080,  -6.85006, -2.51907, -2.27403, -0.96760, 1.38505,
      7.14016,  -5.29428, 2.03995,  8.33777,  -1.08866, 9.93598,  -2.34727, 4.51508,  9.88285,  -6.72229, -5.94667,
      8.92935,  7.51640,  6.30818,  -3.17546, 4.99993,  -2.77358, 5.52634,  7.15288,  -1.37215, 4.91670,  -8.88527,
      1.98117,  -6.50936, -3.61517, -7.12799, 1.12608,  9.85108,  -7.29680, 9.47304,  -0.33523, -9.91071, 7.42134,
      -8.52789, -7.01830, -1.47236, 2.82212,  7.18804,  5.02125,  5.50058,  -6.17321, 6.48908,  -9.92950, -6.71491,
      4.40735,  7.97303,  -4.97025, -5.60849, 1.59477,  -1.81922, 3.71182,  -1.09127, -7.62416, 3.53435,  -9.64159,
      1.32484,  7.28214,  0.27252,  8.80178,  3.66838,  3.98759,  -2.02252, 4.07606,  8.82064,  8.81843,  3.26974,
      2.14770,  -4.84002, 6.72732,  9.31378,  -8.35054, -6.75543, 0.04947,  0.32170,  -7.36081, 8.97718,  -3.82033,
      7.50091,  9.80347,  -9.85488, -3.27167, 0.20347,  8.70520,  -7.09139, -8.08796, -4.49265, -6.69558, -9.82386,
      -9.14083, -4.98351, -8.62950, 5.41930,  -0.34157, -6.57185, 2.84796,  3.53601,  -8.92027, -0.40482, 4.10119,
      9.76288,  5.11375,  3.81444,  -8.32347, 6.88764,  6.94036,  -6.72126, -6.71859, 6.90051,  -0.63200, 2.23868,
      1.76648,  2.33194,  5.19969,  -2.25654, -2.86422, 4.06623,  -2.14925, -4.11815, 0.00345,  7.41533,  -6.53569,
      0.81220,  9.68861,  -0.28606, 9.41337,  -1.86321, 2.28227,  -1.06735, -4.68472, -1.37232, -3.14666, -8.96117,
      -3.28558, -9.98905, 4.53115,  -6.46004, 8.31572,  -1.53614, 7.73957,  6.71808,  -2.61464, -9.50774, -0.10605,
      2.83820,  -6.07639, -8.05567, 7.19532,  6.72458,  -8.00312, 7.50167,  9.14375,  0.77346,  3.22835,  -6.08578,
      0.31340,  -7.80426, -1.62902, 8.78675,  5.50377,  -6.59283, -3.05217, -6.94200, 8.81406,  -0.25877, -9.58286,
      -7.76065, -7.84144, 4.98209,  3.28529,  6.34059,  8.59927,  3.24917,  -7.25361, 2.25505,  2.97473,  0.47787,
      -2.50142, 7.04716,  8.43826,  1.77323,  -6.62130, 6.73207,  3.35351,  -2.59137, 5.57984,  3.54933,  -0.94410,
      -4.35811, 2.79520,  -3.10291, -2.70173, 7.30030,  4.61770,  -5.70417, -6.84566, -0.25059, 0.10636,  9.64547,
      -6.82760, 2.37075,  -7.82050, -2.94639, 5.89824,  4.98369,  0.12572,  -2.39117, 3.23328,  -8.50044, -7.46540,
      1.74079,  -4.88408, 8.08733,  -5.25252, -6.14164, -1.86469, 1.62247,  -4.80371, 1.11036,  4.95736,  -2.01481,
      -4.29467, -6.41822, 0.85665,  9.62229,  0.08958,  9.63046,  -7.88349, 7.33600,  -4.94165, 4.75199,  0.38527,
      6.51710,  -1.57478, -7.06609, -8.11342, 7.98754,  2.23761,  -9.37049, -3.11926, 7.84700,  0.26796,  -0.86136,
      -6.92978, -4.75270, -1.07718, 0.19839,  -7.83948, 5.21860,  -5.59296, 8.28023,  7.97795,  -8.78858, 2.62840,
      0.75065,  4.95771,  3.76687,  -0.05831, 6.48141,  -0.92250, -9.68367, -9.94385, -2.10315, -6.87092, 2.18411,
      1.68643,  -1.18880, 3.82465,  -6.41588, -4.70454, 6.11489,  -1.35429, 8.46660,  -0.48650, -3.45996, 4.07882,
      6.81541,  9.17308,  -1.97050, -5.76110, 1.74471,  1.27162,  0.37992,  -3.93265, 3.43787,  5.80283,  0.95588,
      4.29761,  -6.69165, 2.87665,  -5.62054, -6.31030, -0.72317, 2.72721,  -6.34081, -8.53630, 7.06262,  0.87856,
      7.72985,  -3.86377, -6.96312, -1.58210, -8.50367, 8.34352,  6.58261,  -0.78997, -4.05883, -6.57532, -1.53368,
      -5.81707, 8.21309,  -2.28107, -1.07931, 6.87076,  -5.64831, 9.03000,  5.74198,  3.93601,  5.72864,  -4.49742,
      1.34126,  -4.51461, 0.69773,  4.08540,  -0.47407, 9.33771,  -9.12955, -0.41582, 1.76603,  -9.95335, -2.19463,
      -8.03589, -5.28637, 5.54113,  0.66964,  8.06367,  3.42697,  2.77308,  -8.86805, 6.72570,  -2.39519, 3.34673,
      -2.54326, -1.54055, 5.62776,  4.26711,  -9.73248, 5.78107,  6.63174,  -7.02314, 2.96437,  8.08580,  7.75526,
      -7.81702, 9.53008,  4.75763,  2.66545,  9.14802,  -8.81257, -5.60602, -9.04797, 5.89291,  -5.27688, -9.09167,
      -2.31738, -3.26110, -5.47175, 4.52934,  -7.04145, -1.39708, 0.76648,  -8.86058, 6.67461,  -6.77147, 3.83488,
      7.93292,  -8.44415, -5.42389, -1.18755, 7.32417,  9.59265,  -7.95509, 5.62093,  7.12622,  5.64040,  9.70391,
      7.89931,  3.16333,  0.09640,  -6.19396, -6.02146, 5.45094,  -9.28257, 1.30429,  7.99676,  1.18445,  -4.00784,
      -1.67790, -3.01441, 8.26108,  0.79506,  -1.41668, -3.27432, -6.23652, 6.84399,  4.54946,  -8.84018, -4.91627,
      -6.75428, 5.16635,  2.13818,  -2.12039, 8.50615,  -0.48173, -0.82237, -3.47784, -3.76297, 6.28055,  -2.94092,
      -4.43520, -6.33660, -4.74115, -4.94868, 1.76024,  -4.03274, 7.67758,  1.45710,  8.71992,  -1.17401, 0.94716,
      -0.40519, 2.31730,  7.70648,  -9.08301, -2.60225, 3.06807,  8.55542,  8.51581,  -6.03861, 5.94079,  -4.35557,
      -0.50496, -7.69884, 1.28922,  6.31896,  -9.48662, -7.08348, -3.46687, -7.50693, -0.58527, -2.44543, 4.11910,
      -7.57746, 7.25402,  -9.21561, 9.73029,  2.24737,  -2.02344, 6.47679,  -6.02309, -9.56763, 6.85342,  2.48227,
      7.14803,  9.90175,  -3.56324, -3.12123, -7.39850, -0.33606, 7.16785,  3.89968,  -6.50857, -3.56363, -5.90069,
      6.72724,  -1.14711, -4.38121, -3.80071, -5.63624, -3.85042, 5.21815,  -2.09133, -3.02341, 9.35707,  -3.41354,
      -5.53424, 6.98790,  8.44789,  0.25365,  7.98675,  -9.72488, 1.77071,  3.02028,  2.25621,  -9.62384, -5.26989,
      9.18194,  -9.40513, -5.42840, -5.80036, 3.42547,  6.38808,  -7.05080, 1.16107,  3.64027,  -9.01784, -4.97042,
      -2.22902, -0.96993, 4.11411,  -1.50448, 9.37264,  -7.45777, -2.76789, -0.51130, -0.64516, -6.09574, 7.19147,
      6.34692,  -1.67457, -4.69518, -8.90410, -5.24984, 2.68163,  1.49346,  6.63707,  4.64022,  3.38275,  9.58110,
      6.09008,  0.75057,  -0.43655, -9.55913, 6.07248,  5.68667,  -1.39139, -8.26138, -0.59398, -5.68159, -6.57423,
      -6.83017, 8.95342,  -3.55264, -5.18688, 4.03319,  9.11997,  3.20559,  8.87284,  0.23848,  -9.19120, 1.44016,
      -0.54968, -8.31378, 0.80618,  3.63805,  -2.99200, 4.42686,  5.58783,  1.59461,  -3.27937, -4.83772, -4.13061,
      -8.75030, -8.99610, 9.12702,  -3.83355, -0.04116, 5.80286,  9.80364,  -5.51030, -5.28546, 8.44179,  -5.61439,
      -8.22297, 5.64440,  -7.04520, 0.10237,  -0.60731, -8.78457, 2.47468,  8.79759,  9.10771,  -2.59082, -2.69320,
      7.91567,  7.88814,  1.50752,  5.77965,  1.63419,  -9.32001, -2.35408, 2.25639,  -9.24492, 2.41877,  6.47009,
      0.73462 };
}  // namespace gpukerneltest
